textbook case of spagetti code, worst thing ive written so far but hey it works!
