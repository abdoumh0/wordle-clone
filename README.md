textbook case of spagetti code good lucking figuring this garbage out...